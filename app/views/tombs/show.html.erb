<div class="container productIndex">
  <div class="row">
    <div class="col-12 col-lg-8">
      <% if current_user.admin == true %>
      <%= link_to 'Editar anuncio', edit_tomb_path(@tomb), class: 'btn btn-primary btn-block' %>
      <% end %>
      <small class="text-muted">Se publicó hace <%= time_ago_in_words(@tomb.created_at) %></small>
      <div class="alert alert-secondary" role="alert">
        <%= @tomb.title %>
        <h1 class="display-4"><%= number_to_currency(@tomb.price, precision: 0, delimiter: '.') %></h1>
        <p class="lead">Capacidad: <%= @tomb.capacity %></p>
        <p class="lead"><%= @tomb.entity %> - <%= @entity.address %></p>
        <div class="bd-example">
          <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
              <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
              <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
              <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner mb-3">
              <% if @pictures.length != 0 %>
              <div class="carousel-item active">
                <img src="<%= @pictures.first.image.url %>" class="d-block w-100" alt="...">
              </div>
              <%= @pictures.each do |pic| %>
              <div class="carousel-item">
                <img src="<%= pic.image.url %>" class="d-block w-100" alt="...">
              </div>
              <% end %>
              <% else %>
              <div class="carousel-item active">
                <img src="<%= asset_path 'noimage.JPG' %>" class="d-block w-100" alt="...">
              </div>
              <% end %>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
      </div>
      
      <div class="alert alert-secondary" role="alert">
        <h4>Si lo necesitas, llámanos al</h4>
        
        <div class="alert alert-success text-center" role="alert">
          <strong>300 247 7348</strong>
        </div>

        <h4>o déjanos tus datos para comunicarnos contigo!</h4>
        <%= form_for [@tomb, @tomb.customers.build] do |f| %>
        <div class="form-group">
          <%= f.text_area :name, class: "form-control", placeholder: "Nombre" %>
        </div>
        <div class="form-group">
          <%= f.text_area :email, class: "form-control", placeholder: "Email" %>
        </div>
        <div class="form-group">
          <%= f.text_area :tel, class: "form-control", placeholder: "Teléfono de contacto" %>
        </div>
        <div class="actions text-right">
          <%= f.submit "Contáctame!", class: "btn btn-primary btn-block" %>
        </div>
        <% end %>
      </div>
      <div class="alert alert-secondary" role="alert">
        <h4 class="alert-heading">Características</h4>
        <div class="alert alert-primary" role="alert">
          Descripción: <strong><%= @tomb.description %></strong>
        </div>
        <div class="alert alert-primary" role="alert">
          Dimensiones(cm):
          <% if @tomb.category == 'Lote' %>
          <strong>Área: </strong><%= @tomb.area %>m2 
          <% else %>
          <strong><%= @tomb.height %></strong> de alto, 
          <strong><%= @tomb.width %></strong>  de ancho, y 
          <strong><%= @tomb.depth %></strong> de profundo.
          <% end %>
        </div>
        <% if current_user.admin == true %>
        <div class="alert alert-primary" role="alert">
          Ubicación:
          Sector: <strong><%= @tomb.location %></strong> 
          Grupo/Columna: <strong><%= @tomb.code %> </strong>
          Unidad: <strong><%= @tomb.level %></strong>
        </div>
        <div class="alert alert-primary" role="alert">
          Notas: <strong><%= @tomb.notes %></strong>
        </div>
        <% end %>
      </div>
      <% if current_user.admin == true %>
      <div class="alert alert-secondary" role="alert">
        <h4 class="alert-heading">Manejar imágenes</h4>
        <p>Se recomienda: 1 imagen frontal del ítem, 1 panorámica y 1 del acabado o entorno.</p>
        <% @tomb.pictures.each do |pic| %>
        <div class="card d-inline-block picManager mx-auto" style="width: 12rem;">
          <img class="card-img-top" src="<%= pic.image.url %>" alt="Card image cap" >
          <div class="card-body text-center">
            <%= link_to 'X', tomb_picture_path(pic), method: :delete, class: "btn btn-danger" %>
          </div>
        </div>
        <% end %>
        <hr>
        <% if @tomb.pictures.length < 3 %>
        <%= form_for [@tomb, @tomb.pictures.build] do |f| %>
        <div class="actions mb-3">
          <%= f.file_field :image %>
        </div>
        <div class="actions">
          <%= f.submit "Cargar imagen", class: "btn btn-primary" %>
        </div>
        <p class="mb-0">Máximo 3 fotos de hasta 10MB cada una.</p>
        <% end %>
        <% end %>
      </div>
      <% end %>
    </div>
  </div>
</div>

